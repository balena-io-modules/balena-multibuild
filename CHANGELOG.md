# Change Log

All notable changes to this project will be documented in this file
automatically by Versionist. DO NOT EDIT THIS FILE MANUALLY!
This project adheres to [Semantic Versioning](http://semver.org/).

# v4.10.1
## (2021-04-30)

* Replace 'import' with 'import type' where possible [Paulo Castro]
* Update dependencies including js-yaml v4: safeLoad -> load [Paulo Castro]
* Update `typescript` and set target to ES2018 in tsconfig.json [Paulo Castro]
* Update mocha and replace mocha.opts with .mocharc.js [Paulo Castro]
* Move `@types/*` packages to `devDependencies` section [Paulo Castro]
* Replace Node v8 with Node v14 in CI tests [Paulo Castro]
* Update @balena/lint and lint-staged, run prettify [Paulo Castro]
* Add missing license headers and fix some copyright dates [Paulo Castro]

# v4.10.0
## (2020-10-30)

* Allow users' registry secrets (from build tar stream) to override balena's [Paulo Castro]

# v4.9.1
## (2020-10-19)

* Avoid overwriting docker build options with undefined values [Paulo Castro]

# v4.9.0
## (2020-10-14)

* Add platform in runBuildTask [Robert Günzler]

# v4.8.0
## (2020-10-07)

* Only use platform if docker host supports api version >=1.38 [Robert Günzler]
* Use the correct armv8 platform string [Tomás Tormo]
* Resolve docker platform [Robert Günzler]
* Pass platform option to build [Robert Günzler]

# v4.7.3
## (2020-08-20)

* Add .version/CHANGELOG.yml for nested changelogs [Pagan Gazzard]

# v4.7.2
## (2020-08-13)

* Revert breaking change to `validateRegistrySecrets` from 4.7.1 [Pagan Gazzard]

# v4.7.1
## (2020-07-01)

* Update dependencies and fix typings [Pagan Gazzard]

# v4.7.0
## (2020-06-12)

* Revert "Propagate target platform to builds" [Robert Günzler]

# v4.6.2
## (2020-05-19)

* Remove an extra image parameter from docker-compose when buiding [Cameron Diver]

# v4.6.1
## (2020-05-19)

* Export performSingleBuild and create initializeBuildMetadata [Cameron Diver]

# v4.6.0
## (2020-05-18)

* Propagate target platform to builds [Robert Günzler]

# v4.5.1
## (2020-05-11)

* Add ability to pass progress hook with perform*Resolution [Cameron Diver]

# v4.5.0
## (2020-05-08)

* Add hook to allow dockerfile preprocessing [Scott Lowe]

## 4.4.2 - 2020-03-03

* Update dependencies [Pagan Gazzard]

## 4.4.1 - 2020-02-24

* Update dependencies [Pagan Gazzard]

## 4.4.0 - 2020-02-13

* Don't export path from PathUtils [Cameron Diver]
* Allow adding additional Dockerfile template variables [Cameron Diver]

## 4.3.4 - 2019-11-21

* Expose base images info on LocalImage [Roman Mazur]

## 4.3.3 - 2019-11-06

* Require a slug in container contracts [Cameron Diver]

## 4.3.2 - 2019-10-07

* Get 'npm test' to pass on Windows + Docker Desktop [Paulo Castro]
* Fix path separator in "build secrets" code (Windows compatibility) [Paulo Castro]

## 4.3.1 - 2019-10-02

* Use pre-built external image for build secret population and removal [Paulo Castro]
* Add test for performBuilds function (multibuild.spec.ts) [Paulo Castro]
* Check for non-empty secrets before calling removeSecrets() [Paulo Castro]
* Remove package-lock.json because it is not recommended for libraries [Paulo Castro]

## 4.3.0 - 2019-09-25

* Add support for extracting and reporting container contracts [Cameron Diver]

## 4.2.2 - 2019-09-04

* Switch prepare to prepublishOnly to avoid builds on npm install [Cameron Diver]

## 4.2.1 - 2019-09-04

* Ensure the entire build directory gets included in package [Cameron Diver]

## 4.2.0 - 2019-09-04

* Explicitly bump resin-compose-parse [Cameron Diver]
* Allow spaces in build vars regex [Cameron Diver]
* Improve validation error reporting [Cameron Diver]
* Throw an error when encountering multiple config directories [Cameron Diver]
* Throw upon encountering multiple metadata directories [Cameron Diver]
* Add registry secret handling code [Cameron Diver]

## 4.1.0 - 2019-08-29

* Add single task resolution function to enable better error reporting [Cameron Diver]

## 4.0.2 - 2019-08-21

* Fix "qemu-execve: no such file or directory" with balena build --emulated [Paulo Castro]
* Fix SecretRemovalError when building on different arch than the target device [Paulo Castro]

## 4.0.1 - 2019-07-12

* Fix build secret metadata filtering and filename list [Paulo Castro]

## 4.0.0 - 2019-07-08

* Support build secrets and variables from a .balena directory [Cameron Diver]

## 3.1.0 - 2019-04-22

* Fix tar stream path handling under Windows and bump resin-bundle-resolve [Paulo Castro]

## 3.0.0 - 2019-04-12

* Update resin-bundle-resolve to 4.x [Pagan Gazzard]

## 2.1.6 - 2019-03-26

* Bump docker-progress major version (4.0.0) [Paulo Castro]

## 2.1.5 - 2019-03-25

* Update resin-compose-parse to v2.0.4 [Pablo Carranza Velez]

## 2.1.4 - 2019-03-13

* Bump resin-lint major version (3.0.1) [Paulo Castro]

## 2.1.3 - 2019-03-12

* Bump dependency versions (resin-docker-build and a few others) [Paulo Castro]

## 2.1.2 - 2019-03-04

* Update resin-docker-build to avoid instanceof failures [Cameron Diver]
* Don't use the relative pass when specifying a dockerfile [Cameron Diver]

## 2.1.1 - 2019-03-01

* Bump version for resin-bundle-resolve [Paulo Castro]

## 2.1.0 - 2019-02-19

* Support private registry auth in docker-compose 'image' instruction [Paulo Castro]

## 2.0.0 - 2019-02-19

* Add event listeners to support dockerfile selection [Paulo Castro]

## 1.0.0 - 2019-01-11

* Allow specifying a dockerfile candidate when building [Cameron Diver]

## 0.11.0 - 2019-01-10

* Run prettier on code [Cameron Diver]
* Add prettier and auto-format hooks [Cameron Diver]

## 0.10.0 - 2018-12-17

* Auth: Add support for private docker registry authentication [Paulo Castro]

## v0.9.0 - 2018-09-20

* Cleanup: Add declaration output, fixup tests and tsconfig, package.json [Cameron Diver]
* Fix: Fix lint error in index.ts [Cameron Diver]
* Update: Update typed-error to v3 [Cameron Diver]
* Update: Update resin-compose-parse and resin-bundle-resolve [Cameron Diver]
* Cleanup: Add @types/tar-stream and remove unused typings [Cameron Diver]
* Cleanup: Add build and doc directories to .gitignore [Cameron Diver]

## v0.8.0 - 2018-05-10

* Export a performSingleBuild function, for performing builds individually #32 [Cameron Diver]

## v0.7.0 - 2018-04-30

* Export PathUtils module to resin-multibuild importers #31 [Cameron Diver]

## v0.6.1 - 2018-04-24

* Don't run tests before deploying for auto-deploy #30 [Cameron Diver]

## v0.6.0 - 2018-04-24

* Setup circle auto npm publishing #29 [Cameron Diver]

## v0.5.5 - 2018-04-24

* Fix path name resolution for overlapping build contexts #28 [Cameron Diver]

## v0.5.4 - 2018-03-28

* Revert "Publish only built files" #26 [Cameron Diver]
* Revert "Publish .d.ts files" #26 [Cameron Diver]

## v0.5.3 - 2018-03-27

* Publish .d.ts files #24 [Alexis Svinartchouk]

## v0.5.2 - 2018-03-20

* Publish only built files #22 [Alexis Svinartchouk]
* Use resin-lint #22 [Alexis Svinartchouk]

## v0.5.1 - 2017-12-21

* Tag image via docker build argument, rather than separately #18 [Cameron Diver]

## v0.5.0 - 2017-12-15

* Provide primitive method to work with images directly #17 [Akis Kesoglou]

## v0.4.0 - 2017-12-14

* Indicate project resolution failure with a flag #15 [Cameron Diver]

## v0.3.0 - 2017-12-13

* Allow a build context to be shared between services #11 [Cameron Diver]

## v0.2.0 - 2017-12-07

* Run build before commit #9 [Cameron Diver]
* Populate the dockerfile and project type fields of local image #9 [Cameron Diver]

## v0.1.2 - 2017-12-07

* Forward the docker opts on docker pull #8 [Cameron Diver]
* Record the start and end time of builds and pulls #8 [Cameron Diver]

## v0.1.1 - 2017-12-07

* Fix path resolution when splitting the stream #7 [Cameron Diver]
* Build-task.d.ts -> build-task.ts to solve sporadic resolution errors #7 [Cameron Diver]

## v0.1.0 - 2017-12-06

* Add tests for initial code #3 [Cameron Diver]
* Add initial build code #3 [Cameron Diver]
* Add project specific files #3 [Cameron Diver]

## v0.0.1 - 2017-12-01

* Project initialisation
